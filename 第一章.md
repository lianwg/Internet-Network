> 复习视频+复习大纲

## 第一章

- 计算机网络概述
    - *计算机网络的概念*
        - 计算机网络的定义
            - 计算机网络：将**地理位置不同的**、**独立的**多台计算机通过通信线路连接，实现**资源共享**和信息传递。
        - 计算机网络的组成
            - 终端子网/资源子网
                - 提供需要的**数据**：即共享的软件资源和硬件资源
            - 通信子网
                - 提供信息交换的网络**节点**和通信**线路**
        - 计算机网络的类型
            - 按照拓扑分类
                - 星形结构
                - 树形结构
                - 总线形结构
                - 环形结构
                - 网状结构
            - **按照范围分类**
                - 局域网LAN
                - 城域网MAN
                - 广域网WAN
                - 补充
                    - 个人区域网PAN
                    - 互联网Internet，属于广域网WAN
            - 按照传输方式分类
                - 有线网络
                    - IEEE802.3
                - 无线网络
                    - IEEE802.11
                    - WLAN无线局域网（W:wireless）
                    - WPAN无线个域网
    - 计算机网络体系结构
        - *传输方式*
            - 按照传输方向分
                - 单工
                    - 只允许一个方向的传输
                - 双工
                    - 可以双向传输，但是同一时间线路上只允许一个方向的数据通过
                - 全双工
                    - 现代通信方式，允许同时双向进行数据通信
            - 按照传输对象（方式）分
                - 单播
                - 多播
                - 广播
        - 网络结构
            - 网络边缘
                - 主机（端系统）
                    - 客户/服务器应用模型
                        - 客户发送请求，接收服务器响应
                    - 对等(P2P)应用模型
                        - 无服务器，通信在**对等**实体间直接进行
            - 网络接入
                - 将主机连接到核心网（边缘路由器）的物理链路。
            - 网络核心
                - 互联的路由器网络
                    - 主要功能是路由+转发
        - *数据交换*
            - 电路交换
                - 整个报文从源头到终点**连续**进行传输
                    - 通信时延小，有序传输，没有冲突，控制简单等
                        - 建立连接时间长，独占信道导致利用率低，灵活性差
            - 报文交换
                - 整个报文传送到相邻节点，全部存储下来查找转发表，再转发到下一个结点
                    - 优点
                        - 无需建立连接，随时发送
                        - 动态分配线路，提高线路可靠性（可重新选择不同线路），提高线路利用率
                        - 提供多目标服务
                    - 缺点
                        - 转发时延（存储转发过程）
                        - 需要传输额外的信息量
                        - 需要较大存储缓存空间
            - 分组交换
                - 把报文切分成多个分组，传输到相邻节点再查转发表转发，最后在目的地组装
                    - 数据报
                        - 无连接，可能乱序到达
                            - 优点
                                - 无需建立连接，随时发送分组
                                - *线路利用率高，提高信道使用效率*
                                - 简化存储管理
                                - 加速传输
                                - 减少出错概率和重发数据量
                            - 缺点
                                - 引起了转发时延
                                - 需要传输额外的信息量
                                - 失序、丢失、重复分组
                    - 虚电路
                        - 建立逻辑连接，按序到达
                        - 没有分组失序问题，但是有呼叫建立、数据传输、虚电路释放三个过程
        - 通信协议和体系结构
            - ![](c3cde571-a2f6-48d5-88d1-cfa8675e8c84.png)
            - 多层协议体系结构的必要性
                - 大问题化小
                    - 计算机网络是一个非常复杂的系统，分层可将庞大而复杂的问题，转化为若干较小的局部问题，而这些较小的局部问题就比较**易于研究和处理**。
                - 各层之间相互独立
                    - 各层之间不需要关心其他层是如何实现的，只需要知道自己如何调用下层提供好的功能就可以了
                - 提高了整体灵活性
                    - 每一层都可以使用最适合的技术来实现，你只需要保证你提供的功能以及暴露的接口的规则没有改变就行了。
            - *网络协议三要素*
                - 语法
                    - 用户数据与控制信息的结构与格式，以及数据出现的顺序
                - 语义
                    - 解释控制信息每个部分的意义，规定了需要发出何种控制信息，以及它需要做出什么样的响应或者动作
                - 时序（“同步”）
                    - 对事件发生顺序的详细说明
            - *OSI参考模型（7层）*
                - 下层为上层服务
                    - 应用层
                        - 单位报文，使用应用程序间的交互来完成特定网络服务
                    - 表示层
                        - 处理交互数据的表示方式，例如格式转化、数据的加密解密、数据压缩和恢复功能等
                    - 会话层
                        - 负责维护通信中两个节点之间的会话建立、维护和断开，以及数据的交换
                    - 传输层
                        - 单位报文段，提供**端到端**之间的数据传输服务，实现对数据进行控制和操作的功能
                    - 网络层
                        - 单位分组，在数据链路层基础上， 提供**点到点**之间的通信，提供路由功能，实现拥塞控制、网络互联等功能
                    - 数据链路层
                        - 单位帧，在物理层基础上，提供**结点到结点**之间的服务，采取差错控制和流量控制的方式实现网络互联
                    - 物理层
                        - 单位bit，利用**传输介质**为通信的网络节点建立连接
            - *TCP/IP参考模型（4层）*
                - 应用层
                    - 会话层、表示层、应用层
                - 传输层
                - 网际层
                    - 网络层
                - 网络接口层
                    - 数据链路层和物理层
    - 计算机网络性能分析
        - 指标
            - 网络时延
                - 一个分组从一台主机经过分组交换网络到达目的主机所需时间
            - 丢包
                - 丢包率是指在网络传输过程中丢失报文占传输报文的百分比
            - 吞吐量
                - 单位bit/s，简写为bps。在一个固定的时间内（1 秒），从网络一端传输到另一端的最大数据位数，也可以理解为网络的两个节点之间特定数据流的平均速率
                - 数据包大小/数据发送时间（这次发送到下一次发送）
                - 信道利用率x发送方的速率
            - 信道利用率：某信道有百分之几的时间是被利用的（有数据通过）。完全空闲的信道的利用率是零
                - 并非越高越好
                - 若令 D0 表示网络空闲时的时延，D; 表示网络当前的时延，则在适当的假定条件下，可以用下面的简单公式表示D和 D0之间的关系：D = D0/1-U
                - ![](e13dd416-c19d-49f6-8db1-6827d8fc630e.webp)
            - 网络利用率：**网络利用率**则是全网络的信道利用率的加权平均值
        - 四种时延
            - 传输(发送)
                - 分组从主机或分组交换机内部到线路上所花的时间
                - 数据块长度（比特）/发送速率（比特/秒）
                - 发送速率（比特/秒）：通常是以信道最高数据率发送数据，因此就是**信道带宽**
            - 传播
                - 分组在线路上传播所用的时间
                - 信道长度（米）/**信号在信道上的传播速率（米/秒）**
            - 处理
                - 分组进入分组交换机，分组交换机要进行差错检测，读取分组首部信息，计算决定分组的下一站，这部分所花费的时间是处理时延
            - 排队
                - 在分组交换机内部，分组会按照到达的先后顺序进行转发，如果前面的有分组还没有处理完，后面分组就要排队，在队列中等待的时间就是排队时延
                - 取决于**当时通信量**



## 第三章

- 链路层
    - 数据链路层基础概述
        - *数据链路层概念*
            - 是物理层和网络层之间的协议，提供相邻结点的可靠数据传输
        - 帧的概念
            - 数据链路层的协议**数据单元**
            - 组成
                - ![](/Users/86191/AppData/Local/Temp/95644fd4-4c30-4a04-b23e-a661f34a1bb2.png)
                - 帧头
                    - 源MAC、目的MAC、类型
                        - MAC地址：48位
                - 数据
                - 帧尾
                    - 校验
        - *以太网数据帧中的MAC协议和LLC协议（IEEE 802.3）*
            - 将数据链路层协议划分为上层的LLC协议和下层的MAC协议
            - 以太网：总线型的局域网
                - ![](/Users/86191/AppData/Local/Temp/ea9141cd-20eb-4f56-aaf9-0a33b0813215.png)上面是最初的以太网，下面的是修订后的以太网，是主流，所以802.3局域网也叫做以太网
            - MAC（Multiple Access Control协议，对接物理层）
                - 信道划分介质访问控制协议
                    - MAC协议决定了节点什么时候允许发送分组，而且通常控制对物理层的所有访问。
                    - 作用：数据帧的封装/卸载，帧的寻址和识别，帧的接收与发送，链路的管理，帧的差错控制等。MAC子层的存在屏蔽了不同物理链路层种类的差异性。
            - LLC（对接链路层）
                - LLC逻辑控制访问
                - 作用：传输可靠性保障和控制，数据包的分段与重组。数据包的顺序传播。
            - 注意：
                - 该协议位于OSI七层协议中数据链路层，数据链路层分为上层LLC（逻辑链路控制），和下层的MAC（媒体访问控制），MAC主要负责控制与链接物理层的物理介质。在发送数据的时候，MAC协议可以事先判断是否发送数据，如果可以发送将给数据加上一些控制信息，最终将数据以及控制信息以规定的格式发送到物理层；在接收数据的时候，MAC协议首先判断输入的信息并是否发生传输错误，如果没有错误，则去掉控制信息发送至LLC（逻辑链路控制）层。
        - 数据链路层的两种传输方式
            - 单播
            - 广播
        - *数据链路层的三个基本问题*
            - 封装成帧
                - **封装成帧就是在一段数据的前后分别添加首部和尾部**，这样就构成了一个帧，接收端在收到物理层上交的比特流后，就能根据首部和尾部的标记，从收到的比特流中**识别帧的开始和结束**帧同步
                - 接收方应当能从接收的二进制比特流中区分帧的起始和终止
                - 组帧的四种方法
                    - 1.字符技术法
                        - 帧首部使用一个计数字段（第一个字节，八位）来标明帧内字符数
                            - 缺点：当有一个字节出现错误，就会导致后面的字节全部出现错误。
                    - 2.字符（节）填充法
                        - 当数据出现SOH时，会判断出当前为数据开始字节，用EOT代表数据结束字节
                        - 当中间部分有部分字节和SOH、EOT重复时，会在该字节之前加上**ESC（转义字符）**来告诉接收方当前字节无须作判断，直接接收即可。即当接收到ESC时，会删除ESC转义字符，然后直接接收后面的字节
                    - 3.零比特填充法
                        - 01111110作为起始和结尾
                        - 在发送端，扫描整个数据字段，只要连续5个1，在后面填1个0
                        - 在接收端收到一个帧时，先找到标志字段确定边界，再用硬件对比特流进行扫描，发现连续5个1就删掉后面的1个0，得到原始字段
                    - 4.违规编码法
                        - 因为曼彻斯特编码是高-低（1），或低-高（0）显示的编码，因此可以使用高-高，低-低（违规编码）来定界帧的起始和终止
                    - 由于字节计数法中Count字段的脆弱性（其值若有差错将导致灾难性后果）及字符填充实现上的复杂性和不兼容性，目前较普遍使用的帧同步法是比特填充和违规编码法。
            - 透明传输
                - 透明传输是指不管所传数据是什么样的比特组合，都应当能够在链路上传输，而不会引起对帧边界的判断错误
                - 字符（节）填充法、零比特填充法...其他？
            - 差错检测
                - 收到正确的帧就要向发送端发送确认，发送端在一定的期限内若没有收到对方的确认，就认为出现了差错，因而就进行**重传**，直到收到对方的确认为止
                    - 奇偶校验
                        - 奇数校验：数据位上1的个数个校验位上1的个数之和为奇数
                        - 偶数校验数据位上1的个数个校验位上1的个数之和为偶数
                        - 单比特位偶校验：当有偶数个bit为发送错误的时候，这种方式无法检测，准确率不高
                        - 二位偶校验：可以检测也可以纠错（二维精确定位出错bit位）
                    - CRC
                        - 可以纠错
        - 局域网中的设备
            - 集线器Hub
                - 集线器的主要功能是对接受的信号进行再生整形放大，以扩大网络的传输距离，同时把所有的结点集中在以它为中心的结点上
                - 共享带宽
                - 物理层
            - 交换机Switch
                - 是一种用于电（光）信号转发的网络设备。可以为接入交换机的任意两个网络结点提供独享的电信号通路。以太网交换机是最常见的交换机。
                - 独享带宽
                - 链路层
            - 网桥
                - 两个端口的交换机
                - 物理层与链路层之间
                - 划分为两个冲突域

## 数据链路层的通信协议

- *媒介访问控制*：介质访问控制协议（MAC Multiple Access Control）
    - 采取一定措施，使得两队节点之间的通信不会发生互相干扰
        - 静态划分信道：
            - 信道划分介质访问控制协议：基于多路复用技术划分资源
                - 网络负载重：共享信道效率高，且公平
                    - 网络负载轻：共享信道效率低
                - 多路复用技术
                    - 把多个信号组合在一条物理信道上进行传输，使得多个计算机或终端设备共享信道资源，提高信道利用率
                - 信道划分介质访问控制：将使用介质的每个设备与来自同一信道上的其他设备的通信隔离开，把时域和频域资源合理地分配给网络上的设备
                    - 频分多路复用FDM
                        - 用户在分配到一定的频带后，在通信过程中自始自终都占用这个频带。频分复用的所有用户在同样的时间占用不同的带宽（频率带宽）资源。**“并行”**
                    - 时分多路复用TDM
                        - 将时间划分为一段段等长的时分复用帧（TDM帧）。每一个时分复用的用户在每一个TDM帧中占用固定序号的时隙，所有用户轮流占用信道。**“并发”**
                        - 改进的时分复用--统计时分复用STDM（按需动态分配时隙）
                    - 波分多路复用WDM
                        - 波分多路复用就是光的频分多路复用，在一根光纤中传输多种不同波长（频率）的光信号，由于波长（频率）不同，所以各路光信号互不干扰，最后再用波长分解复用器将各路波长分解出来
                    - 码分多路复用CDM
                        - 码分多址（CDMA）是一种码分复用的一种方式。
                        - 1比特分为多个码片/芯片（chip），每一个站点被指定一个唯一的m位芯片序列。发送1时站点发送芯片序列，发送0时，发送芯片序列反码（通常把0写成-1）。
                        - 如何不打架：多个结点同时发送数据的时候，要求各个结点芯片序列相互正交。
                        - 如何合并：各路数据在信道中被线性相加。
                        - 如何分离：合并的数据和源站规格化内积。
        - 动态分配信道
            - 轮询访问介质访问控制：轮询访问MAC协议/轮流协议/轮转访问MAC协议
                - 既要不产生冲突，又要发送全部带宽
                - 轮询协议
                    - 思想：主结点轮流“邀请”从属结点发送数据
                    - 问题：1.轮询开销 2.等待延迟 3.单点故障
                - 令牌环协议
                    - 令牌：一个特殊格式的MAC控制帧，不含任何信息。控制信道的使用，确保同一时刻只有一个结点独占信道。令牌环网中无碰撞
                    - 每个结点都可以在一定时间内（令牌持有时间）获得发送数据的权利，并不是无限制地持有令牌。
                    - 问题：1.令牌开销 2.等待延迟 3.单点故障
                    - 应用：应用于令牌环网（物理星型拓扑，逻辑环形拓扑）。采用令牌传递方式的网络常用于**负载较重、通信量较大**的网络中。
            - **随机访问介质访问控制**：随机访问MAC协议
                - 用户根据意愿随机发送信息，发送信息时可独占信道带宽
                    - 网络负载重：产生冲突开销
                    - 网络负载轻：共享信道效率高，单个节点可利用信道全部带宽
                - ALOHA协议
                    - 思想：不监听信道，不按时间槽发送，随机发送。想发就发。
                    - 冲突检测：如果发生冲突，接收方就会检测出差错，然后**不予确定**，发送方在一定时间内收不到就判断发生冲突
                    - 冲突解决：超时后等一随机时间在重传
                - 时隙(Slotted)ALOHA协议
                    - **控制想发就发的随意性**：把时间分成若干个相同的时间片，所有用户在时间片开始时刻同步接入网络信道，若发生冲突，则必须等到下一个时间片开始时刻再发送
                - *CSMA协议*
                    - 载波监听多路访问协议（carrier sense multiple access）
                    - CS：载波侦听/监听，每一个站在**发送数据之前**要检测一下总线上是否有其他计算机在发送数据
                    - MA：多点接入，表示许多计算机以多点接入的方式连接在一根总线上
                    - 思想：发送帧之前，监听信道
                        - 监听结果
                            - 监听到信道空闲：发送完整帧
                            - 监听到信道忙：推迟发送
                        - 1-坚持CSMA
                            - 信道空闲：马上发；信道忙：继续监听，空闲就发；遇到冲突就随机等待再监听
                            - 优点：避免媒体利用率损失；缺点：冲突不可避免
                        - （0-）非坚持CSMA
                            - 信道空闲：马上发；信道忙：随即等待再监听
                            - 优点：采用随机的重发延迟时间减少冲突发生率；存在信道空闲，媒体利用率低
                        - p-坚持CSMA
                            - 信道空闲：以p概率传输，不传则等到下一个时间槽；信道忙：继续监听直到空闲
                                - 优点：既能减少冲突，又减少媒体空闲时间；缺点：如果发生冲突会坚持把数据发送完，造成浪费
                    - 冲突检测：当几个站同时在总线上发送数据时，总线上的**信号电压摆动值**将会增大（互相叠加）。当一个站检测到的信号电压摆动值超过一定门限值时，就认为总线上至少有两个站同时在发送数据，表明产生了碰撞，即发生了冲突
                - CSMA/CD协议：*以太网*
                    - 载波监听多点接入/碰撞检测
                    - CD：碰撞检测（冲突检测），**边发送边监听**，适配器边发送数据边检测信道上信号电压的变化情况，以判断是否有其他结点在发送数据（即是否产生冲突）
                    - 传播时延对载波监听的影响
                        - ![](4a60a6ec-266c-4d04-b3f3-0f26ac2b99b3.webp)
                        - **争用期/冲突窗口/碰撞窗口=总线端到端的往返时延：2r**
                    - *截断二进制指数规避算法*
                        - 用于确定碰撞后的重传时间
                        - 1.基本退避（推迟）时间为争用期2r
                            - 以太网争用期为51.2us
                        - 2.定义参数k，它等于重传次数，但k不超过10，即k=min[重传次数，10]。当重传次数不超过10时，k等于重传次数；当重传次数大于10时，k就不再增大而一直等于10
                        - 3.从离散的整数集合[0, 1, ..., 2^k-1]中随机取出一个数m，重传所需要退避的时间就是r倍的基本退避时间，即2r`*`m
                        - 4,**当重传达16次仍不能成功时**，说明网络太拥挤，认为此帧永远无法正确发出，**抛弃此帧并向高层报告出错**
                    - 最小帧长问题
                        - 保证了站点在帧在发送过程中，能够检测到帧是否发生了碰撞
                        - 帧的**传输时延**至少要两倍于信号在总线中的**传播时延**
                        - ![](fcf9104c-8601-44dd-a9c5-5720a69d3939.webp)
                        - *最小帧长*=2x总线传播时延x数据传输速率
                            - 以太网规定最小帧长64字节
                    - 最大帧长问题
                        - 如果一个帧的长度过大，一个站点不停地发送帧，让其他站点一直无法无法使用信道；如果帧的长度过大，接收方的缓冲区可能也装不下该帧产生溢出
                        - 以太网规定是1518字节
                - CSMA/CA协议：*无线局域网*
                    - 载波监听多点接入/碰撞
                    - 为什么要有CSMA/CA？
                        - 无线局域网
                            - 无法做到全面检测碰撞
                        - 隐蔽站
                            - 当A和C都检测不到信号，认为信道空闲时，同时向终端B发送数据帧，就会导致冲突
                    - 思想：**发送数据前，先检测信道是否空闲**。空闲则发出RTS（request to send），RTS包括发射端的地址、接收端的地址、下一份数据持续发送的时间等信息；信道忙则等待。接收端收到RTS后，将响应CTS（clear to send）。**发送端收到CTS后，开始发送数据帧（同时预约信道：发送方告知其他站点自己要传多久数据）**。接收端收到数据帧后，将用CRC来检验数据是否正确，正确则响应ACK帧。**发送方收到ACK就可以进行下一个数据帧的发送**，若没有则一直重传至规定重发次数为止（采用二进制指数退避算法来确定随机的推迟时间）
                        - 1.预约信道
                        - 2.ACK帧
                        - 3.RTS/CTS帧（可选，主要解决隐蔽站问题）
                - CSMA/CA与CSMA/CD相比较
                    - 相同点：都属于CSMA思路，其核心是先听再说；二者出现冲突后都进行有上限重传
                    - 不同点：
                        - 1.传输介质不同：CSMA/CD用于总线式以太网【有线】，而CSMA/CA用于无线局域网【无线】
                        - 2，载波检测方式不同：因传输介质不同，检测方式也不同。CSMA/CD通过电缆中电压的变化来检测，当数据发生碰撞时，电缆中的电压就会随着发生变化；而CSMA.CA采用能量检测（ED）、载波监听（CS）和能量载波混合检测三种检测信道空闲的方式
                        - 3，CSMA/CD检测冲突，CSMA/CA避免冲突

## 局域网基本概念和体系结构

- 局域网（LAN）：指在某一区域内有多台计算机互联成的计算机组，使用广播信道。**决定局域网的主要要素为：网络拓扑，传输介质与介质访问控制方法**
    - 特点
        - 1.覆盖地理范围较小，只在一个相对独立的局部范围内联，如一座或集中的建筑群内
        - 2.使用专门铺设的**传输介质（双绞线、同轴电缆）进行联网**，数据传输速率高（10Mb/s~10Gb/s）
        - 3，通信延迟时间短，误码率低，可靠性较高
        - 4.各站为平等关系，共享传输信道
        - 5.多采用分布式控制和广播式通信，能进行广播和组播
    - 四种拓扑结构
        - ![](6bc94df8-04a0-475b-80f1-01ba429892bd.webp)
    - 介质访问控制方法
        - 1.CSMA/CD：常用于总线型局域网，也用于树型网络
        - 2.令牌总线：常用于总线型局域网，也用于树型网络
        - 3.令牌环：用于环形局域网，如令牌环网
    - 网桥
        - ![](daf949ca-e696-4b6e-9c53-3b83c7825599.webp)网段A和网段B如果是同构网是可以直接用电缆相连，但是如果是不同种类的网络，比如以太网和令牌环网不能直接用介质相连，这时候需要中转设备（网桥）进行相连。网桥只有若干个端口，因此一般直接相连的是网段，而不是主机
        - 作用：工作在数据链路层的一种网络互连设备，**在互连的LAN之间实现帧的存储和转发**；可以**连接不同类型的局域网**；根据MAC帧的目的地址对收到的帧进行**转发**；网桥具有**过滤帧**的功能，当网桥收到一个帧时，并不是向所有的端口转发此帧，而是先检查此帧的目的MAC地址，然后再确定将该帧转发到哪一个端口
        - 工作流程
            - 1.从某个端口收到的二层报文，解析二层报文的源MAC和目的MAC
            - 2.根据源MAC学习形成MAC表
            - 3.根据目的MAC，**原封不动的**将该报文转发到**适当的**出端口，从而保证最终目的设备能收到这个报文。这个转发过程有两个关键：
                - a.**原封不动的：** 所谓原封不动，*就是交换机不会修改报文内容，包括报文的源MAC，目的MAC（这一点与路由器形成区别，路由器工作在三层，在转发过程中每一跳都会修改源MAC和目的MAC）*
                - b,**适当的：**交换机要以尽可能小的代价确保报文最终能安全可靠的到达目的地。
                    - **已知单播 - 单播**:对于单播报文，如果知道目的地址在哪个端口（MAC表中能找到该目的MAC），就从该端口转发出去
                    - **未知单播 - 泛洪**:对于单播报文，如果暂时还不知道目的地址是哪个端口，则从所有非源端口泛洪出去
                    - **组播广播 - 泛洪**：对于广播和组播，也需要泛洪
        - 工作原理：![](8f1b8540-b84b-4b79-81c0-8f6a462a9dbd.webp)网桥是不支持VLAN的二层交换机
            - MAC学习：维护MAC表（mac地址到出接口的映射表）
                - 监听学习：当交换机从某个端口收到一个数据包，它先读取包头中的源MAC地址，这样它就知道源MAC地址的机器是连在哪个端口上的
                - 监听更新：网络拓扑不可能是永不改变的，当发生改变时，会改变映射关系
                - 定时老化：网络拓扑变化还有一种可能性，就是直接将机器C拔掉了，这种情况下怎么保证mac表的正确性呢。很简单，如果一定时间内该端口没有收到C的任何报文，则假设该主机以及离线，将改主机对应的mac表象老化删除。 （假如该主机还在，只是这段时间没有发送报文怎么办？ 想想，其实没有关系，大不了再次泛洪，重新学习）
            - 转发环路：转发环路的问题，*通常需要通过STP等信令协议进行破环。通过STP对某些链路进行剪枝操作，故意让某些链路停止工作，从而将物理上的有环网络（离散数学中的图），转变为逻辑上的无环网络（离散数学中的树）*
                - 生成树算法：就是把一个环形的结构改变成一个树形的结构。STP协议就是用来讲物理上存在环路的网络，通过一种算法，**在逻辑上阻塞一些端口，来生成一个逻辑上的树形结构**
                    - 逻辑上断开环路，防止广播风暴
                    - 当线路故障，阻塞接口激活恢复通信，起备份线路作用
                    - 生成树算法
                        - 1.选择根网桥（boot bridge）
                            - 按照生成树算法的定义：交换机网桥ID值最小，**优先级小**的被选择为根网桥；优先级相同情况下，**MAC地址小**的为根网桥
                            - 网桥ID值：网桥ID是一个8字节的字段，前2字节的十进制数成为网桥优先级，后6字节是网桥的MAC地址。网桥优先级的默认值是32768，取值范围是0~65535。**网桥ID中的MAC地址是交换机自身的MAC地址**
                        - 2.选择根端口（root ports）
                            - 根端口存在于非根网桥上，需要在**每个非根网桥上**选择一个根端口
                            - 选择根端口时，顺序如下：a、到根网桥最低的根路径成本（带宽越大路径成本越小） b、直连的网桥ID最小 c、 端口ID最小（注：比较的是接收到的对端的端口ID值）
                            - 端口ID是一个2字节的STP参数，由1字节端口优先级和1字节端口编号组成。优先级的默认值是128，取值范围是0~255。**端口编号不是端口号**，但是端口号低的端口，端口编号也小
                        - 3.选择指定端口（designated ports）
                            - 为了消除环路形成的可能，STP进行最后的计算，在**每一个网段上**选择一个指定端口
                            - 选择指定端口顺序如下：a、 根路径成本较低； b、所在的交换机的网桥ID值较小； c、  端口ID值较小（比较的是自身的端口ID值）
                    - 桥协议数据单元（BPDU）
                        - 交换机之间通过BPDU（桥协议数据单元）来交换网桥ID、根路径成本等信息。BPDU帧利用了一个STP组播地址（01-80-c2-00-00-00）作为它的一个目的地址，使之能到达相邻的、并处于STP侦听状态的交换机。BPDU报文每隔2S向所有的交换机端口发送一次报文，以便交换机能交换当前最新的拓扑信息，并迅速识别和检测其中的环路。
                        - 类型：配置BPDU，用于生成树计算；拓扑变更通告（topology change notification，TCN），BPDU用于通告网络拓扑的变化
                        - 报文字段：BPDU中包含根网桥ID、根路径成本、发送网桥ID、端口ID和计时器等，对BPDU几个关键字段作用的解释如下：
                            - 根网桥ID：有一个2字节优先级和一个6字节网桥MAC地址组成。这个信息组合表明已经被选定为根网桥的设备标识
                            - 根路径成本：说明这个BPDU从根网桥传输了多远、成本是多少。这个字段的值决定哪些端口进行转发，哪些端口将被阻断
                            - 发送网桥ID：这是发送该BPDU网桥信息，由网桥的优先级和网桥的MAC地址组成
                            - 端口ID：由一字节的端口优先级和一字节的端口编号组成
                            - 计时器：用于说明生成树用多长时间能完成它的每项功能。这些功能包括报文老化时间、最大老化时间、访问时间和转发延迟
                    - STP利用BPDU选择根网桥的过程
                        - 当一台交换机第一次启动时，假设自己是根网桥，在BPDU报文中的根网桥字段填入自己的网桥ID
                        - 当接收到其他交换机发出的BPDU后，比较网桥ID，选择较小的添加到根网桥ID中
                        - 当全网所有的交换机接收到全部的BPDU并作比较后，就可以选择出唯一的一个根网桥
    - 二三层交换机工作原理
        - 二层交换机：二层交换技术是发展比较成熟， 二层交换机属数据链路层设备，可以识别数据包中的 MAC地址信息， 根据MAC地址进行转发，并将这些MAC地址与对应的端口记录在自己内部的一个地址表中 
        - 三层交换机：**三层交换技术就是将路由技术与交换技术合二为一的技术**。在对第一个数据流进行路由后，它将会产生一个MAC地址与IP地址的映射表，当同样的数据流再次通过时，将根据此表直接从二层通过而不是再次路由，从而消除了路由器进行路由选择而造成网络的延迟，提高了数据包转发的效率
            - 路由器：路由器工作于OSI七层协议中的第三层，其主要任务是接收来自一个网络接口的数据包，根据其中所含的目的地址，决定转发到下一个目的地址。因此，路由器首先得在转发路由表中查找它的目的地址，若找到了目的地址，就在数据包的帧格前添加下一个MAC地址，同时IP数据包头的TTL（Time To Live）域也开始减数，并重新计算校验和。当数据包被送到输出端口时，它需要按顺序等待，以便被传送到输出链路上
    - 网桥、集线器，二层交换机、三层交换机和路由器的比较：
        - 集线器：工作在物理层，将数据报转发到相应的的物理接口。集线器是一种简单的网络设备，用于将多个计算机连接在一起形成一个局域网。它的主要功能是**将接收到的数据包广播到所有连接的计算机上**，没有任何智能处理。当一个计算机发送数据时，集线器会将数据复制到所有其他端口上，以便所有设备都能接收到。
        - 网桥：工作在数据链路层，基于MAC地址进行数据包的**转发和过滤**。网桥是一种连接两个局域网的设备，它具有学习和过滤数据包的功能。网桥通过学习每个物理接口上的MAC地址，维护一个转发表，从而只将数据包发送到目标MAC地址所在的接口，减少了广播和冲突。
        - 二层交换机：工作在数据链路层，使用MAC地址进行数据包的**转发和选择性过滤**。它可以学习和记住连接到其端口的设备的MAC地址，并根据目标MAC地址将数据包定向转发。交换机能够实现分组交换，提供更高的数据转发速率和网络带宽利用率。
        - 三层交换机：**工作在网络层，三层交换机使用了三层交换技术，即二层交换技术＋三层转发技术**。它解决了局域网中网段划分之后，网段中子网必须依赖路由器进行管理的局面，解决了传统路由器低速、复杂所造成的网络瓶颈问题。
        - 路由器：工作在网络层，使用IP地址进行数据包的转发和路由选择。路由器是一种能够连接多个网络并进行数据路由的设备。它通过分析网络层（IP层）的目标IP地址，根据路由表决定将数据包转发到哪个网络接口，以实现不同网络之间的数据交换和路由选择。
    - 分类
        - 以太网
            - IEEE 802.3以太网规约
                - 以太网媒介
                    - ![](0d43c287-2fe5-4cf1-9c6c-c9732ea9e2d5.webp)
                - 以太网帧格式
                    - 该帧包含6个域：前导码（preamble）包含8个字节（octet）；目的地址（DA）包含6个字节；源地址（SA）包含6个字节；类型域包含2个字节；数据域包含46-1500字节；帧效验序列（FCS）包含4个字节
            - CSMA/CD
        - 无线局域网
            - 概念和应用
                - 指采用无线通信技术的局域网
                - 移动接入、便携设备联网
            - IEEE 802.11体系结构：是一个**有固定基础设施的无线局域网**的国际标准
                - 基本概念（Station，AP，BSS，ESS，DS）
                    - 使用星型拓扑，其中心为接入点AP
                    - 最小构件是基本服务集BSS，包括：
                        - 一个基站Station
                        - 若干个移动站
                    - 所有的站在本BSS以内都可以直接通信，但在和本BSS以外的站通信时必须通过本BSS的基站
                    - 基础结构网路拓展ESS：多个BSS组成的多区网，一个孤立的BSS通过接入点AP链接到一个分配系统DS，然后再连接另一个BSS构成ESS
                - 体系结构图
                    - ![](3e2842a2-8187-46fd-a83c-700b8d53d40d.png)
            - CSMA/CA
                - 分布式协调功能（DCF）
                    - 在DCF方式下，没有中心控制站点，每个站点使用CSMA/CA协议通争用信道来获取发送权，这是802.11定义的默认方式
                - 点协调功能（PCF）
                    - PCF方式使用集中控制的接入算法（一般在接入点AP实现集中控制），是802.11定义的可选方式，在实际中较少使用
            - 802.11 b/g频段及传输速率
                - ![](103f37bffa534d65aff5978dbf777d4d.jpg)
                - ![](bed5ed124aac4898b3ca42ac053bb536.jpg)
    - 冲突域和广播域
        - 冲突域（基于第一层物理层）
            - 在以太网中，如果某个CSMA/CD网络上的两台计算机在同时通信时会发生冲突，那么这个CSMA/CD网络就是一个冲突域（collision domain)
            - 如果以太网中各个网段以**集线器Hub连接**，因为不能避免冲突，所以它们仍然是**一个冲突域**
            - 第二层设备能隔离冲突域，比如二层交换机。交换机（路由器也能）能缩小冲突域的范围，**交换接的每一个端口就是一个冲突域**
        - 广播域（基于第二层数据链路层）
            - 广播是一种信息的传播方式，指网络中的某一设备同时向网络中所有的其它设备发送数据，这个数据所能广播到的范围即为广播域(Broadcast Domain) 
            - 第三层设备才能隔离广播域，比如路由器 Router。路由器能隔离广播域，其每一个端口就是一个广播域。（或者划分vlan也可以隔离），还可以隔离二层广播风暴
    - *虚拟局域网（实验） VLAN（Virtual LAN）*
        - VLAN即虚拟局域网，是将一个物理的LAN在逻辑上划分为多个广播域的通信技术，VLAN内的主机间可以直接通信，而VLAN间不能直接通信，从而将广播报文限制在一个VLAN内
        - 优点和目的
            - 1.划分广播域
                - 减少垃圾数据
            - 2.增强局域网的安全性
            - 3.提高健壮性
            - 4.灵活构建工作组
        - 划分VLAN的方式
            - *基于端口*
                - 给交换机的每个接口配置不同的PVID，当一个数据帧进入交换机接口时，如果没有带VLAN标签且该接口上配置了PVID，那么该数据帧就会被打上接口的PVID。如果进入的帧已经带有VLAN标签，那么不会再增加VLAN标签，即使端口已经配置了PVID（不覆盖）
                    - *Access*
                        - 只允许通过一个VLAN
                    - *Trunk*
                        - 允许通过多个VLAN
                    - hybrid
            - 基于子网
                - 配置好子网域VLAN映射表，如果交换设备收到的是untagged（不带VLAN标签）帧，交换设备根据报文中的源IP地址信息，确认添加的VLAN ID。将指定网段或IP地址发出的报文在指定的VLAN中传输，**减轻了网络管理着的任务量，且有利于管理**
            - 基于MAC地址
                - 先配置好MAC地址和VLAN映射关系表，当终端用户的物理位置发生改变，不需要重新配置VLAN。**提高了终端用户的安全性和接入的灵活性**
            - 基于协议
                - 将网络中提供的服务类型域VLAN相绑定，方便管理和维护。需要对网络中所有的协议类型和VLAN ID 的映射关系表进行初始配置。需要分析各种协议的地址格式并进行相应的转换，消耗交换机较多的资源，速度上稍具劣势
            - 基于匹配策略
                - 先在交换机上配置好终端的MAC地址和IP地址，并与VLAN 并联。只有符合条件的终端才能加入指定VLAN。符合策略的终端加入指定VLAN后，严禁修改IP地址和MAC地址，否则会导致终端从指定VLAN中退出



- 网络传输媒介利用率分析
    - U = 帧传输时间/帧的总时间（第一个bit发出最后一个bit收到）
        - PPP：U=1/1+a; a是一个bit从点到另一个点的时间
        - 令牌环：U=T1/（T1+T2）; T1是平均传送一个帧的时间，设为1，T2是发送令牌环的时间（**最后一个bit发送，令牌环释放，去往目的站点**）
            - case1:a\<1(帧比环长)则T2 = a/N(N是站点个数)
            - case2:a\>1(帧比环短)则T2 = a-1 + a/N
        - ALOHA：假设所有帧一样长
            - A=NxP（结点在t0发送数据）xP（没有别人在[t0-1,t0]发送）xP（没有别人在[t0,t0+1]发送）=Nxpx(1-p)^Nx(1-p)^N-1
            - U约等于A，取极限=1/2e 此时p=1/2N
        - Slotted ALOHA：
            - 某节点在某一时隙成功的概率：自己成功且其他节点都不成功
            - 任意结点在某一时隙成功的概率A：上面的值xN（站点个数）
            - A的最大值（求导）：得到p=1/N（p是站点在每个时隙发送的概率）时，A最大...
            - U约等于e^-1
        - CSMA/CD（p-resist）：p是检测到空闲后以p概率传输
            - A = Np(1-p)^N-1
            - 前j次失败，第j+1次成功的概率是：A(1-A)^j，j可以是1，2，...无穷，算得**次数j的期望值**：1-A/A
            - U=帧传输时间（默认为1）/帧传输时间+bit传播时间+平均竞争时间=1/1+a+2a`*`(（1-A）/A)=1/1+(2-A)a/A
            - N无穷，U约等于1/(2e-1)a=1/1+4.44a
    - **CSMA/CD**
        - 即载波侦听多路访问/冲突检测，是广播型信道中采用一种随机访问技术的竞争型访问方法，具有多目标地址的特点
            - 总线型网络广播信道传输数据，防止冲突的技术
        - 四大要点
            - 1.先听再发
            - 2.边听边发
            - 3.冲突停止
            - 4.延迟后发
    - **PPP（Point to Point Protocol）**
        - 点对点通信是一对一信道，因此不会发生碰撞，比较简单，采用PPP协议
            - 单播
        - PPP协议就是用户计算机和ISP（互联网服务提供商）进行通信时使用的数据链路层的协议
        - PPP最初设计是为了两个对等结点之间的IP流量传输提供一种**封装协议**
        - 封装数据帧
    - *CRC*
        - 循环冗余校验



## 第四章

- 网络层
    - 网络层的作用（单位分组）
        - 提供端到端的服务
            - 网络层的目的是实现两个端系统之间的数据透明传送，具体功能包括**寻址、转发和路由选择、连接的建立（虚电路）**、保持和终止等。它提供的服务使传输层不需要了解网络中的数据传输和交换技术
            - **路由：**当数据包到达路由器的输入链路时，路由器会将数据包移动到路由器的输出链路。
            - 虚电路建立连接：虚电路的所有分组**要通过的一系列链路与路由器**。网络层也为沿着该路径的每条链路确定一个 VC 号。在沿着路径的每台路由器的转发表中增加一表项。在虚电路建立期间，网络层还可以预留虚电路路径上的资源(如带宽)。
    - 网际层IP协议：IP协议是TCP/IP协议的核心，所有的TCP，UDP，IMCP，IGCP的数据都以IP数据格式传输。IP协议不可靠（没有提供未到达处理办法）。
        - IP基本原理：IP 协议把上层数据报封装成 IP 数据报后进行传输，如果 IP 数据报太大，还要对数据报进行分片后再传输，到了目的地址处再进行组装还原，以适应不同物理网络对一次所能传输数据大小的要求。
        - 异构网络环境下，internet协议的工作过程
        - 协议
            - 协议原语与相关参数
            - IPv4首部格式
                - ![](d4745353-cc29-40e6-9ef9-0d6280ed3b0c.png)
                - 载荷长度：总长度-IHLx4byte
            - ARP地址解析协议
                - 通过IP地址获得物理地址
                - 原理：
                - 流程
            - RARP反地址解析协议
            - ICMP网际控制报文协议
                - 通过ICMP传输控制消息
                    - 控制消息：网络通不通、主机是否可达、路由是否可用等网络本身的消息，如ping
                - ping和traceroute的实现原理
                    - ping:**Ping 会发送 **`echo request message`** 到某个地址，然后等待应（reply），当 echo request 到达目标地址以后，在一个有效的时间内（timeout 之前）返回 echo reply message 给源地址，则说明目的地可达。如在有效时间内，没有收到回应，则在发送端显示超时。**Ping 命令是把 ICMP 报文中的**标示符**置为发送该 ICMP 报文的进程，这样在对端可以区分出从本端运行的多个 Ping 实例。Ping 命令每发送一个 ICMP 回显请求报文，顺序号就加 1，顺序号从 1 开始，不同的系统发送回显请求的数量不同，默认情况发送 5 个回显请求报文。也可以通过命令行参数设 置发送回显请求报文的个数，如果对端可达，则在对端会相应回应 5 个和请求端同样序号的 ICMP 回应报文。
                    - traceroute:源端首先发送 3 个 TTL 字段的值都为 1 的 UDP 数据报给远程设备，使用随机的任何大于 32768 的端口地址作为目标设备的接受报文端口，TTL 为1的数据报到达第一跳路由器以后随即超时，路由器响应源设备一个 ICMP 的超时报文，之后源端再发送3个 UDP 数据报，这次更改 TTL 值为 2，即经过 2 个路由器以后，响应源端 tICMP 超时报文，依次类推，直到这些 UDP 报文到达了目标设备。由于发送的报文中的目的端口，目标设备接收到 ICMP 报文后，**由于报文的端口是一个在目标设备没有使用的端口，目标设备就会响应 ICMP port unreachable 信息给源端，表示目标端口不可达，同时说明 Tracert 执行完毕。**从而可以从源端显示的结果中，看到到目标设备所经过的路径。**Tracert 发送数据报的 TTL 值最大可以到 30，每一次发送如果在指定的时间的内没有回应报文，在发送端就会显示超时，如果发送 30 跳的g值后，仍然显示为超时，表明无法达到目标设备，测试失败。**默认情况没有发送报文的超时时间为 5 秒，可以在 0ms～65535ms 之 间进行设置。
            - IGMP网际组管理协议
                - 是用于管理网路协议**多播**组员的一种通信协议
                - IP主机和相邻的路由器利用IGMP来创建多播组的组成员。组播方式解决了单播情况下数据的重复拷贝及带宽的重复占用，也解决了广播方式下带宽资源的浪费
    - *IP地址*
        - IP地址的概念
            - IP地址
                - IP地址是IP协议提供的一种统一的地址格式，它为互联网上的每一个网络和每一台主机分配一个逻辑地址，以此来屏蔽物理地址的差异
            - 组成
                - 4个字节，32位组成，一般用点分十进制的方式表达
                    - 0.0.0.0、128.0.0.0
            - IP地址和MAC地址的区别
                - 1.IP地址是逻辑地址，MAC地址是物理地址
                - 2.MAC地址唯一，IP地址不唯一
                - 3.MAC地址主要工作在第二层，IP地址在网络层
                - 4.MAC地址48位，IP地址一般是32位（v6是128位）
                - 5.IP地址的分配取决于网络拓扑，MAC地址分配取决于制造商
        - IP地址的组成
            - **由主机地址和网络地址组成**
            - 主机地址/主机号
                - 标识某一台设备的地址
            - 网络地址/网络号
                - 标识某一个网段的地址
            - 子网掩码
                - 作用：**用于区分网络号和主机号**
                    - 用来指明一个IP地址的哪些位标识的是主机所在的子网，哪些位标识的是主机的位掩码。子网掩码不能单独存在，必须结合IP地址一起使用
                - 是网络号的比特全为1
        - IP地址的分类
            - A类
                - 第一个字节为网络号，**第一个字节第一位是0**
                    - A类地址网络数量较少，有127（2^7-1）个网络，每个网络可以容纳主机1600多万台
                    - 1.0.0.1 到 127.255.255.254
                    - 子网掩码是255.0.0.0
            - B类
                - 前两个字节为网络号，**第一个字节字节前两位是10**
                - 适用于中等规模的网络，有16384个网络，每个网络能容纳主机6万多台
                - 128.0.0.1 到 191.255.255.254
                - 子网掩码是255.255.0.0
            - C类
                - 前三个字节为网络号，**第一个字节字节前三位是110**
                - 网络地址数较多，有209万余个网络，适用于小规模局域网络，每个网络最多只能包含256台计算机
                - 192.0.0.1到223.255.255.254
                - 子网掩码是255.255.255.0
            - D类
                - **最高位必须是1110**
                - 在历史上被叫做多播地址，即组播地址。在以太网中，多播地址命名了一组应该在这个网络中应用接收到一个分组的站点。
                - 224.0.0.0到239.255.255.255
            - E类
                - **最高位必须是1111**
                - 保留
            - 特殊地址
                - 网络地址
                    - 主机号为全0的地址不可用
                - 广播地址
                    - 主机号为全1的地址
                - 回环地址
                    - 127.0.0.0
        - IPv6
            - IPv4地址满足不了需求，出现匮乏的情况，所以诞生了IPv6继续使用。v6地址由128位，16个字节组成，一般表现形式为十六进制。
    - *子网划分*
        - 子网划分
            - 概念：用于减少地址浪费，将一个大的有类网络，划分成若干个小的子网，使得IP地址的使用更加科学
            - 通过修改子网掩码，起到更精细划分网络号和主机号的作用
        - VLSM（Variable Length Subnet Mask）
            - 可变长子网掩码，是为了有效的使用无类别域间路由（CIDR）和路由汇聚（route summary）来控制路由表的大小，它是网络管理员常用的IP寻址技术，可以对子网进行层次化编址，以便最有效的利用现有的地址空间
        - 给你iP地址和子网掩码，求网段
    - *子网聚集*
    - 分组交换网络
        - 路由器是实现分组交换的关键构建。其任务是转发收到的分组。这是网络核心部分最重要的功能。
        - 基本思想
            - 分组交换采用**存储转发技术**。把一个报文划分为几个分组后再进行传送。通常，我们把要发送的整块数据成为一个报文。在发送报文之前，先把一个报文划分为一个个更小的等长数据段。每一个数据包前面，加上一些由必要的控制信息组成的**首部(header)**后，就构成了一个分组（packet)。**分组的首部包含了诸如目的地址和源地址等重要的控制信息。**凭借这些信息，每一个分组可以在互联网中**独立地选择传输路径，并被正确地交付到分组传输的终点**。
    - 分组基本交换网络中的路由
        - 路由
            - 路由是什么？
                - 路由（routing）是指分组从源到目的地时，决定端到端路径的网络范围的进程。路由是指报文转发的路径信息，通过路由可以确认转发IP报文的路径。
                    - 路由时网络层最主要的工作任务
            - 路由器
                - 网络层的基本设备
                - 数据转发
                - 一个端口代表一个网段，路由器中存放着通往各个网段的表格，叫做路由表
            - 路由表
                - routing table, 或称作路由择域信息库（RIB Routing Information Base）, 是一个存储在路由器或者联网计算机中的电子表格（文件）或类数据库。
                - 路由表存储着指向特定网络地址的路径，路由表相当于一个小型数据库，实现一组目的地址到下一条路由 IP 地址的映射
            - 网关
                - Gateway，又称网间连接器、协议转换器
                - **用于两个高层协议不同的网络互联，既可以用于广域网互联，又可以用于局域网互联**
        - 性能评估指标
            - 
        - 路由信息的更新方式
            - 手工配置
            - 路由协议动态维护，路由器将基于管理距离（ Administrative Distance， AD）和路由度量（metric）选出进入路由表的最佳路径
        - 路由算法
            - 集中式路由：集中式路由选择算法（centralized routing algorithm）用完整的、全局性的网络知识计算出从源到目的地之间的**最低开销路径**
            - 分布式路由：在分散式路由选择算法（decentralized routing algorithm）中，路由器以迭代、分布式的方式计算出最低开销路径。没有节点拥有关于所有网络链路开销的完整信息。相反，每个节点仅有与其直接相连链路的开销知识即可开始工作
                - 洪泛：基本思想是每个节点都是用广播转发收到的数据分组，若收到重复分组则进行丢弃处理。需要设定合适的TTL（discarding packets）值，保证数据分组只经过有限跳路由。为了进行重复分组检测，每个节点需要维护一个数据分组序号SEQ和一张路由表，源节点每发送一个数据分组则将SEQ增1，并将该SEQ添加到数据分组的IP头部，其余节点收到数据分组后会将该SEQ记录到路由表并根据该SEQ进行重复分组检测。
                - 随机行走
                    - 从一个或一系列顶点开始遍历一张图，在任意一个顶点，遍历者将以概率1-a游走到这个顶点的邻居顶点，以概率a跳跃到图中任何一个顶点（称a为跳转发生概率）。每次游走后得到一个概率分布，刻画了图中每一个顶点被访问的概率，用这个概率分布作为下一次游走的输入反复迭代这一过程，在某种条件下这个概率会收敛，得到一个平稳的概率分布。
                - 自适应路由
                    - 与相邻路由器交换信息，优化完成
            - 最小代价路由算法及其性能分析
                - Bellman-Ford（分布式、局部信息）
                    - 算法：x到y的带权最短路径长度 = min(x的邻居v){x到v的权重+v到y的带权最短路径长度}
                        - 路径费用增加：产生无穷计数问题
                            - 毒性逆转：若节点a通过节点b到达节点c，则节点a将虚假但善意地告诉b：a到c的距离是无穷大，从而避免环路问题；
                    - 性能分析：异步迭代
                - Dijstra Algorithm（集中式、全局信息）
                    - 算法：
                    - 性能分析：存在震荡的可能
                - 第一、二、三代互联网路由算法之间的对比和改进
            - 链路代价的算法
        - 自洽系统与路由的配置方式：
            - 自洽系统：因特网将整个互联网划分为许多较小的自洽系统（一个自洽系统包括多个局域网），每个自洽系统有权决定自身内部的协议。
            - 如果两个自洽系统需要通信，则需要一个在自洽系统之间的协议屏蔽这些差异。因此因特网将路由选择协议划分为两类：
                - IRP（IGP）：内部网关协议，自洽系统内部使用的路由选择协议，包括RIP、OSPF
                - ERP（EGP）：外部网关协议，自洽系统之间使用的路由选择协议，如BGP
            - 内部路由协议
                - 距离向量协议（RIP）
                    - 是一种分布式的基于距离向量的路由选择协议，UDP，向自己的相邻结点交换自己的路由表信息。通过UDP报文发送，定期交换；路由改变；对方请求
                - 链路状态协议（OSPF）
                    - 向本自洽系统中的所有路由器发送信息，使用泛洪法（RIP仅向自己相邻的几个路由器发送信息），直接IP数据报。每当一条链路状态变化时，路由器就会广播链路状态信息；即使链路状态未发生变化，它也要周期性地广播链路状态。
                - 路由结构图与路由表的生成
            - BGP
                - BGP的功能：BGP 是不同自治系统的路由器之间交换路由信息的协议。边界网关协议 BGP 只能是力求寻找一条能够到达目的网络且比较好的路由（不能兜圈子），而并非要寻找一条最佳路由。。**防环**
                - 基本报文类型和工作方式
                    - ![](b9ccea26-12a0-4a3e-a14b-016992d3f9b5.png)
                    - 使用 TCP 连接交换路由信息的两个 BGP 发言人， 彼此成为对方的邻站（neighbor）或对等站（peer） 
            - 静态路由
                - 静态路由（去哪个网段，往哪走）
                    - 由管理员手工配置、配置方便，对系统要求低，适用于拓扑结构简单稳定的小型网络
                - 缺省路由（不知道去哪个网段，默认走）
                    - 是一种特殊的路由，当报文没有在路由表中找到具体的匹配项时才使用的路由
            - 动态路由
                - 动态路由
                    - 通过动态路由协议来实现不同网段的路由互通
                    - 动态路由协议由自己的路由算法，能够自动适应网络拓扑的变化，适用于具有一定数量的三层设备的网络
                - 动态路由协议
                    - *RIP*
                        - RIP（路由协议信息）
                        - 基于矢量（跳数）的动态路由协议
                        - 适用于中小规模的网络拓扑，最大跳数为15
                        - 可能产生环路问题
                    - *OSPF*
                        - OSPF（开放式最短路径优先）、Dijstra算法
                        - 基于链路状态的协议
                        - 使用SPF算法，计算最短路径，树形协议，无环
                    - *BGP*
                        - 自治系统之间的路由协议
                    - IS-IS
                        - 内部网关协议
                        - Intemediate System-to-Intermediate Ststem，中间系统到中间系统。
                        - 与OSPF类似，基于路由路划分区域，OSPF利用接口划分
                    - RIP和OSPF的区别
                        - 1.RIP基于矢量，OSPF基于链路状态
                        - 2.RIP适用于中小型网络拓扑，OSPF适用于较大规模的网络
                        - `3.OSPF支持可变长度子网掩码（VLSM），RIP不支持`*不完全对*
                        - 4.OSPF的收敛速度比RIP迅速
                        - 5.OSPF防环，RIP不防环
    - CIDR表达（如12.253.96.0/18）
    - IPv6与IPv4
        - 异同
        - 优缺点
    - NAT原理及优缺点
        - **路由器对数据包进行地址转换，路由器在接收到内部数据包时将内部源IP地址转化为公有IP地址后在进行路由转发。**
        - 优点 ：NAT允许企业内部网络使用私有地址，并通过设置合法的地址集，使内部网络可以与互联网进行通信，从而达到节省合法注册地址的目的。NAT增强了内部网络与公共网络连接时的灵活性。它可以通过使用多地址集、备份地址集和负载分担/均衡地址集，来确保可靠的公网连接。
        - 缺点：NAT会使延迟增大。NAT增加了配置和配错的复杂性。使用和实施NAT时，无法实现对IP包端对端的路径跟踪。NAT也可能会使某些需要使用内嵌IP地址的应用不能正常工作，因为它隐藏了端到端的IP地址。
        - 由于NAT的采用，**我们无法再通过统计IP地址数的方式来确定连接外网的主机数量。为了解决这一问题**，相关研究人员已经设计了一系列的检测方案，对NAT后主机数量进行检测。检测方案可分为主动检测和被动检测两种。
            - 因为序列号是有序的，可以将序列号分组，有多少组就是多少个主机（估算）
            - 被动检测方法中，比较典型的有IP ID序列法、timestamp检测法以及cookie检测法。其中IP ID检测法利用某些操作系统IP报文中ID字段与所发IP报文数目同步递增的特点，通过检测网关出口流量中连续的ID序列段数目来估计主机数目。而timestamp检测法利用不同主机发出的TCP报文中timestamp字段与接收时间表现出不同的线性关系这一特点，通过计算不同的线性关系数目来估计主机数目。对于cookie检测法，则是通过提取所捕获http报文的cookie字段，统计同一网站下不同cookie的数量来估计主机数目。
    - DHCP动态地址获取过程:
        - 第一步：DHCP Client请求IP——DHCP Client 以广播的方式发出DHCP Discover报文; 
        - 第二步：DHCP server响应——DHCP Server向DHCP Client发送一个DHCP Offer报文; 
        - 第三步：DHCP Client选择IP——DHCP Client 会发出一个广播的DHCP Request报文，在选项字段中会加入选中的 DHCP Server的IP地址和需要的IP地址;
        -  第四步：DHCP server确认租约——DHCP Server向DHCP Client响应一个DHCP ACK报文，并在选项字段中增加IP地址的使用租期信息。（正式下发IP）
    - IP组播（Multicast）
        - 组播地址、组播模型、组播组管理：IGMP
        - 组播路由机制
        - Shared-tree，Source-based tree

## 第五章

- 传输层
    - 传输层概论
        - 传输层
            - 提供端到端的服务：**编址、复用、流控制、面向连接、可靠传输**
            - 从通信和信息处理的角度看，传输层向上层应用层提供通信服务
            - 所谓的端口号，就像门牌号。客户端可以通过IP地址找到对应的服务器端，**服务器端有很多个端口，每个应用程序对应一个端口号**，通过端口号客户端才能真正的访问到该服务器。
        - 端口号
            - FTP：21（20）
                - 文件传输协议
                - 21连接；20传数据
            - TELNET：23`*`
                - 远程登录
            - SMTP：25`*`
                - SMTP（电子邮件传输协议）
                - POP3（邮局协议版本3）：110
            - DNS：53`*`
                - 域名系统
            - TFTP：69
                - 简单文件传输协议
            - HTTP：80`*`
                - 超文本传输协议
            - SNMP：161
                - 简单网络管理协议
            - HTTPS：443`*`
                - 超文本传输安全协议
    - 可靠传输协议的设计
        - 数据包损坏：校验和，ACK，NAK信号
            - 校验和：检测冲突？溢出的话回卷 需要校验的部分16位每份，依次二进制反码求和，得到结果放入校验和字段
            - ACK：接收方收到了数据报回发告知
            - NAK：接收方没收到数据报回发高中
            - 如果ACK/NAK出错？引入新的序号机制，发送方在每个分组加入序号，如果ACK/NAK出错，就重传当前分组，接收方丢弃重复分组
            - 停等协议：发送方发送一个分组，然后等待接收方的应答
        - 数据包丢失：超时计时器
        - 按序交付、副本检测：以序列号区分，要求序列号空间足够大
        - 传输效率：流水线协议
    - 流水线协议
        - 流水线：允许传输多个包，序列号要求升序，在接收者和发送者方都要有缓冲区
        - 滑动窗口
            - 发送窗口：发送缓冲区的大小：一次最多可以发送多少个未经确认的分组
            - 接收窗口：接收窗口的大小决定发送窗口的大小；存在”未接收并未准备接收“，但不存在”已接收未回复ACK“
        - 接收方如何发送ACK？
            - Cumulative：累计确认，即发送ACK时只用发送最后一个消息的ACK即可，连续片段。
            - Selective：允许TCP单独确认非连续的片段。
        - 流水线差错恢复协议（重发）
            - 回退N步 Go-Back N（**GBN**）
                - 接收端发送累计型确认，如果不连续则不确认；如果接收窗口尺寸=1只接受顺序，不接受乱序
                - 发送端设定**一个**最老的未确定分组的定时器，到时间重传所有未确认分组
            - 选择重传（SR）
                - 接收端对每个分组单独确认；窗口尺寸\>1可以乱序
                - 发送方为**每个**未确认分组都设置一个定时器
    - 传输层的两个重要协议
        - TCP比UDP可靠，但传输效率不如
        - *TCP*：传输控制协议，是TCP/IP体系中较为复杂的协议，是传输层中最重要的协议（像电路交换，有连接）
            - 基本服务：TCP协议是一个**面向连接的、可靠的传输协议**，它提供一种可靠的字节流，能保证数据完整、无损并且按顺序到达。TCP尽量连续不断地测试网络的负载并且控制发送数据的速度以避免网络过载。另外，TCP试图将数据按照规定的顺序发送。
            - 协议首部格式：源端口(4个字节)、目的端口(4)、序**号seq(4)：报文段首字节在字节流的编号、确认号ack(4)：期望从另一方收到的下一个字节的序号（累计确认）**、数据偏移(4)、保留(4)、控制位(8)、窗口、检验和(2)、紧急指针(16)
            - 流量控制
                - 滑动窗口rwnd机制的设计
                - 信用量窗口
                - TCP复合的窗口管理方式
                    - 基于接收方缓冲区、基本机制和工作流程：接收方控制发送方，不让发送方发送太多导致接收缓冲区溢出：接收方在其向发送方的TCP段头部的rwnd字段通告其空闲buffer的大小
            - 连接维护
                - 建立：三次握手
                    - ![](6917bb65-4d2d-4dec-96ce-3d5ab6901559.png)
                    - ACK：TCP首部的标志位。**TCP规定，在连接建立后，所有传送的报文段必须把ACK置1**
                    - 同步**SYN**：在建立连接时用来同步序号。当SYN=1且ACK=0时，表明这是一个连接请求报文段。对方若同意建立连接，则应在响应的报文段中使SYN=1且ACK=1。
                    - 必要性：是为了在建立连接的时候，**避免重复连接，防止旧的重复连接引发连接混乱问题，通过三次握手可以得到一个确认的可靠初始序列号seq**，两次握手不行，并且三次握手也是最节省资源的连接方式。
                - 终止：四次挥手
                    - ![](9cbb36f3-90ec-4abe-92bf-3a4f6daba919.png)
                    - 第一次挥手：客户端请求断开连接，向服务器发送一个数据包，首部格式内容为FIN=1,ACK=0
                    - 第二次挥手：服务器收到后，给客户端发一个数据包，首部格式内容为FIN=0,ACK=1（第二次挥手后服务器还可以向客户进行数据传送）
                    - 第三次挥手：服务器请求断开连接，给客户端发送一个数据包，首部格式内容FIN=1,ACK1
                    - 第四次挥手：客户端收到后，向服务器发送一个确认的数据包，首部格式内容为FIN=0, ACK=1
            - 拥塞控制算法
                - 时延RTT估计算法
                    - RTT：一个数据包从发出去到回来的时间
                    - SampleRTT：**就是从某报文段交给IP到该报文段的确认被收到之间的时间量**。TCP会为一个**已发送但目前尚未被确认**的报文段估计SampleRTT，绝对**不会为已被重传的报文段**计算SampleRTT。
                    - EstimatedRTT：TCP维持的SampleRTT加权平均值
                        - 如果a很接近0，新的样本影响不大；如果a很接近1，新的样本影响较大
                        - EstimatedRTT = (1 - a)`*` 旧的EstimatedRTT + a `*` 新的SampleRTT（推荐a = 0.125)
                    - DevRTT：RTT偏差的加权平均
                        - RTTd1 = RTTs1/2
                        - 新的RTTd = （1-b）`*`旧的RTTD + b`*`| RTTs - 新的RTT样本 |
                        - 推荐b=0.25
                    - 超时重传时间RTO = RTTs+4`*`RTTd
                - RTO计时器管理算法
                    - TCP对每个连接维护一个超时定时器
                    - **出现超时重传时，新的RTO=两倍旧的RTO**
                - Jacobson‘s Reno
                    - 发送方维护一个叫做拥塞窗口cwnd的状态变量，其值取决于网络的拥塞程度并且动态变化
                        - 维护原则：只要没有出现拥塞，拥塞窗口增大；出现拥塞，拥塞窗口减小
                        - 怎么判断网络是否拥塞：发生超时重传
                    - 发送方将拥塞窗口cwnd作为发送窗口swnd
                    - 慢启动（一开始向网络注入的报文段少）
                        - 维护一个开始门限ssthresh(阈值)状态变量
                            - 当cwnd\<ssthresh：使用**慢开始算法，按传输轮次指数级增长cwnd**；
                            - cwnd\>ssthresh：停止使用慢开始，而改用拥塞避免算法
                            - =：都可以
                    - 拥塞避免
                        - 并非完全避免拥塞，在阶段截断线性（增1）增长cwnd，使网络比较不容易拥塞
                    - **重传计数器超时，判断网络可能出现了拥塞，则将ssthresh更新为拥塞时cwnd值的一半，将cwnd减到1，重新开始慢开始算法**
                    - 快重传
                        - 情况：报文段丢失但网络并没有拥塞，发送方会误以为拥塞而将cwnd减为1开始慢开始，**降低了传输效率**
                        - 采用快重传让发送方尽可能早知道发生了个别报文段的丢失
                        - 原理：尽快进行重传而不是等超时计时器超时再重传
                            - 要求接收方立刻发送确认
                            - 即使收到失序报文段也要立即发出对“已收到报文段”的重复确认
                            - **发送方一旦收到3个连续的重复确认，就立即重传相应报文段**
                - 快恢复
                    - 发送方一旦收到3个连续的重复确认，知道时丢失了个别报文段，不启用慢开始，启用快恢复
                    - 流程：发送方将慢开始门限和cwnd都调整为当前窗口值的一半，开始执行拥塞避免算法
                        - *也有的算法是将cwnd增大一些，=更新后的ssthresh（cwnd的一半）+3*
            - TCP的主要特点：
                - 1.**面向连接的传输层协议**
                - 2.提供可靠的交付服务
                - 3.提供全双工通信
                - 4.面向字节流
            - 窗口
                - 固定窗口
                    - 如果窗口过小，当传输比较大的数据时需要不停的对数据进行确认，会造成很大的延迟
                - 滑动窗口
                    - 滑动窗口是一种流量控制技术。本质上时描述接收方的TCP数据报缓冲区大小的数据，发送方根据这个数据来计算自己最多能发送多长的数据，如果发送方收到接收方的窗口大小为0的TCP数据报，那么发送方将停止发送数据，等到接收方发送窗口大小不为0的数据报的到来
                - 拥塞处理和流量控制
        - *UDP*：更像分组交换
            - 用户数据报协议：UDP
            - UDP在IP数据报服务之上增加了一些功能:复用和分用、差错检测
                - UDP报文段：源端口号、目的端口号、长度、**校验和**、应用程序数据（报文）
            - UDP的主要特点：
                - 1.**无连接**，简单（发送端和接收端没有连接状态）
                - 2.尽最大努力交付，**不可靠**
                - 3.面向报文且没有拥塞控制和流量控制
                - 4.开销较小、传输效率较高
            - 应用：流媒体（丢失不敏感，速率敏感、应用可控制传输速率）
            - UDP首部的概念
    - 数据网络中的拥塞控制
        - 拥塞问题
            - 分组丢失（路由器缓冲区溢出）
            - 分组经历比较长的延迟（在路由器的队列中排队）
        - 网络拥塞和性能指标
        - 拥塞情况下网络吞吐率特征：下降
        - 拥塞控制方式
            - 抑制分组：ICMP通知源节点
            - 反压：要求每一跳减少运输
            - 警告位：报头一个bit，通过ACK传回去
            - 随机早期丢弃（RED）
            - 公平队列
                - Max-Min fairness：
                    - 要点：如果你的需求没有被满足，那么没有人比你得到更多
                    - 步骤：先把C/N分配给需求最小的用户，这可能超出了他的需求，**将超出部分回收**，再将(C-C1)/(N-1)分给需求次小的用户...依次重复上述过程，**直到某一次分给用户的资源不能满足用户。此时将剩余的资源平分给剩下的人。**
                - Fair Queuing：对于每个数据包，计算数据包的最后一位离开路由器的时间，然后**按照截止时间的递增顺序**提供服务
    - 网络服务质量
        - 不同类型应用对QoS要求：弹性流量和非弹性流量
        - 综合服务体系（ISA）
            - RSVP协议
            - 优先级排队，使用资源预留协议RSVP让每个路由器预留带宽，为流建立软状态
        - 区分服务（DS）
            - 将流量划分成类，利用服务级别协议SLA对不同DS字段的流量不同处理





- *流量调度算法：漏桶机制和令牌桶机制*
    - 漏桶机制：让数据包以固定速率出缓冲区
        - 漏桶算法思路很简单，请求先进入到漏桶里，漏桶以固定的速度出水，也就是处理请求，当水加的过快，则会直接溢出，也就是拒绝请求，可以看出**漏桶算法能强行限制数据的传输速率**。
        - 对于很多场景来说，除了要求能够限制数据的平均传输速率外，**还要求允许某种程度的突发传输**。这时候漏桶算法可能就不合适了，令牌桶算法更为适合。
    - 令牌桶机制：每个时间片恒定掉令牌。若令牌桶最大容量为b个令牌，每秒生成r个令牌，那么在长度为t的时间内，数据包量≤rt+b
        - 令牌桶算法是网络流量整形和速率限制中最常使用的一种算法。典型情况下，令牌桶算法用来控制发送到网络上的数据的数目，并允许突发数据的发送。
        - 大小固定的令牌桶可自行以恒定的速率源源不断地产生令牌。如果令牌不被消耗，或者被消耗的速度小于产生的速度，令牌就会不断地增多，直到把桶填满。后面再产生的令牌就会从桶中溢出。最后桶中可以保存的最大令牌数永远不会超过桶的大小。
        - 传送到令牌桶的数据包需要消耗令牌。不同大小的数据包，消耗的令牌数量不一样。令牌桶这种控制机制基于令牌桶中是否存在令牌来指示什么时候可以发送流量。令牌桶中的每一个令牌都代表一个字节。如果令牌桶中存在令牌，则允许发送流量；而如果令牌桶中不存在令牌，则不允许发送流量。
        - 因此，如果突发门限被合理地配置并且令牌桶中有足够的令牌，那么流量就可以以峰值速率发送。







## 第六章

- 应用层
    - 网络应用模型
        - 客户/服务器模型
            - 服务器：提供计算服务的设备 1.永久提供服务 2.具有永久性的IP地址/域名
            - 客户机：请求计算服务的主机  1. 与服务器通信，使用服务器提供的服务 2. 间歇性的接入网络。 3. 可能使用动态IP地址 4. 不与其他客户机**直接**通信
            - 应用：Web、文件传输FTP、远程登录、电子邮件
        - P2P模型
            - 1. 整个网络上传的内容都不会保存在一个中心的服务器上。各节点都有上传或者下载功能 2.不存在服务器，只存在主机，这些主机既可以**提供服务**，也可以请求**服务** 3.任意端节点可以直接通信。4.节点间歇性接入网络 5.可能会有动态IP地址 6.可扩展性比较好(大量主机涌入网络，不用担心资源不够用或者贷款受限等问题，自身就携带资源）7.网络健壮性强(一个主机挂掉，不影响其他主机)
    - 应用层的作用
        - 通过位于不同主机中的多个应用进程之间的通信和协同工作完成。应用层的内容就是具体定义通信规则
            - 是最贴近用户的一层
    - 应用层中常见的协议
        - *域名解析系统DNS*
            - DNS服务器：把域名解析成IP地址
            - 域名结构：每一个域名用标号隔开如：`mail.cctv.com`分别是`三级域名.二级域名.顶级域名`
                - 完整版的域名最后都会有一个点，比如www.baidu.com. 最后的点叫做**根** .但是访问的时候不写这个根
            - 域名服务器
                - 本地域名服务器（默认域名服务器）
                    - 每一个服务提供商、每一个大学、基本都有一个自己的本地域名服务器。  本地域名服务器一般离我们的主机比较近，不超过几个路由器，比如我和要访问的主机都在同一个因特网服务提供商的网络内，就很有可能只在服务提供商处就完成了域名解析。有了本地域名服务器就可能更快完成域名解析任务
                - 根域名服务器：掌握顶级域名服务器的域名IP地址映射关系。
                    - 当本地域名服务器的缓存中查询不到我们需要的IP域名映射时，就向根域名服务器询问
                - ![](9413a63b-e9b4-4e63-8e17-5558a4d5172a.webp)
            - 域名解析过程
                - ![](f0768d69-3006-4e39-aea4-8567ec0732d5.webp)
                - 迭代：自己问
                - 递归：别人问
                - 一般第二次以后访问域名 都会在本地域名服务器的高速缓存中找到对应的IP地址/ 或者本地域名服务器中记载了顶级域名服务器，就不需要先找根域名服务器，而是根据顶级域名服务器直接找权限域名服务器。本地域名服务器的高速缓存中 域名IP映射对 一般会设置计时器，定时更新，比如2天。实际上现在有的主机也有了高速缓存来储存**IP域名映射对**，在开机的时候，我们的主机就会先去自己记载的local DNS里下载**IP域名映射对** 。记录在本机中，连本地域名服务器也不需要访问了。
            - **DNS端口号53**
        - *文件传输协议FTP*
            - FTP提供的是交互式的访问，允许客户指明文件类型和格式（比如说指明是否用ascii 码），并允许文件具有存取权限（比如访问文件的用户必须输入相应的password）。FTP屏蔽了计算机系统的细节，所以适合在异构网络中任意计算机之间传送文件。
            - 使用TCP连接，传输数据
            - 工作原理：
                - 
            - **端口号21连接(控制连接)，20传输数据（数据连接）**
        - 远程终端协议TELNET
            - 使用TCP连接，远程登陆到远地的另一台主机上
            - 端口号23
        - 万维网和HTTP协议
            - 超文本传输协议HTTP，是一个简单的请求-响应协议
            - 80
        - *电子邮件协议*
            - 客户/服务器体系结构
                - 邮件服务器就是电子邮件系统的基础设施，邮件服务器的功能就是发送和接收邮件，同时还要负责维护用户的邮箱。
                - A用户\<------\>邮件服务器\<------\>B用户
            - 电子邮件格式与MIME
                - MIME格式分为消息头和消息体两部分（邮件头和邮件体）
            - SMTP电子邮件传输协议
                - 发送邮件
                - 25
            - POP3邮局协议版本3
                - 接收邮件
                - 110
        - DHCP动态主机配置协议
            - 指的是由服务器控制一段IP地址范围，客户机登陆服务器时就可以自动**获得服务器分配的IP地址和子网掩码**
            - 68 
    - *WWW*
        - WWW 是一个资料空间。WWW 的内核部分是由三个标准构成的：
            - 统一资源定位符(URL)：负责标识万维网上的各种文档，并使每个文档在整个万维网内有唯一的标识符。一般形式是：\<协议\>[://](://)\<主机\>:\<端口\>/\<路径\>。
            - 超文本传输协议(HTTP)：是一个应用层协议，使用 TCP 连接进行可靠的传输。
            - 超文本标记语言(HTML)：是一种文档结构的标记语言，对页面上的各种信息、格式进行描述。
        - HTTP协议：HTTP协议是[Hyper](https://so.csdn.net/so/search?q=Hyper&amp;spm=1001.2101.3001.7020) Text Transfer Protocol（超文本传输协议）的缩写。HTTP 协议和 TCP/IP 协议族内的其他众多的协议相同， 用于客户端和服务器之间的通信。请求访问文本或图像等资源的一端称为客户端， 而提供资源响应的一端称为服务器端。
        - Web缓存
            - **Web缓存**（或**HTTP缓存**）是用于临时存储（[缓存](https://baike.baidu.com/item/%E7%BC%93%E5%AD%98?fromModule=lemma_inlink)）Web文档（如HTML页面和[图像](https://baike.baidu.com/item/%E5%9B%BE%E5%83%8F?fromModule=lemma_inlink)），以减少[服务器](https://baike.baidu.com/item/%E6%9C%8D%E5%8A%A1%E5%99%A8?fromModule=lemma_inlink)延迟的一种[信息技术](https://baike.baidu.com/item/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF?fromModule=lemma_inlink)。Web缓存系统会保存下通过这套系统的文档的副本；如果满足某些条件，则可以由缓存满足后续请求。
        - CDN
            - [内容分发网络](https://www.zhihu.com/search?q=%E5%86%85%E5%AE%B9%E5%88%86%E5%8F%91%E7%BD%91%E7%BB%9C&amp;search_source=Entity&amp;hybrid_search_source=Entity&amp;hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A1604554133%7D)（Content Delivery Network，简称CDN）是建立并覆盖在承载网之上，由分布在不同区域的边缘节点服务器群组成的分布式网络。
            - CDN应用广泛，支持多种行业、多种场景内容加速，例如：图片小文件、大文件下载、视音频点播、直播流媒体、全站加速、安全加速。



## 第七章

- 网络安全
    - 网络安全概论
        - 网络安全
            - Cyber Security 是指网络系统的硬件、软件及其系统中的数据受到保护，不因偶然的或恶意的原因而遭受到破坏、更改、泄露，系统连续可靠正常地运行，网络服务不中断
        - 计算机网络面临的威胁主要分为两大类
            - 主动攻击
                - 主动地去做一些在网络基础上的恶意行为：恶意篡改信息数据、发布恶意程序脚本等
                - 篡改
                - 恶意程序
                - 拒绝服务
            - 被动攻击
                - 被动攻击主要是收集信息而不是访问，不改变数据本身的结构，也不对软硬件数据造成影响
                - 截取
                - 截获
                - 窃取
                - 流量分析
        - 网络系统的特性
            - 保密性
                - 信息不泄露给非授权用户、实体或过程，或供其利用
            - 完整性
                - 数据未经授权不能进行改变，即信息在存储或传输过程中保持不被修改、不被破坏和丢失
            - 可用性
                - **可被授权实体访问并按需求使用。**即当需要时能否存取所需的信息。例如网络环境下拒绝服务、破坏网络和有关系统的正常运行等都属于对可用性的攻击
            - 可靠性
                - 对信息的传播及内容具有控制能力
            - 不可抵赖性
                - 出现安全问题时提供依据与手段



- 加密和互交
    - 加密和解密
        - 加密
            - 是以某种特殊的算法改变原有的信息数据，使得未授权的用户即使获得了已加密的信息，但因为不知道解密的方法，仍然无法了解信息的内容
                - 加密手段
                    - MD5加密（信息-摘要算法）
                        - 128位
                    - AES加密（对称密钥加密）
                        - 128、192、256位
                    - SHA1加密（安全哈希算法）
                        - 160位
                    - RSA加密`*`
                        - 公钥加密、私钥加密
                            - 1024位
            - 解密
                - 加密的逆过程就是解密
        - 公钥和私钥
            - 对称加密
                - 加密机制的组成元素
                    - 算法
                        - 将普通的信息或可以理解的信息与一串数字(密钥)结合，产生不可理解的密文
                    - 密钥
                        - 用来对数据进行编码和解密的一串数字
                - 对加密机制的要求
                    - 1.必须提供高度的安全性
                    - 2.具有相当高的复杂性，使得破译的开销超过获得的利益，但同时又便于理解和掌握
                    - 3，安全性应当不依赖于算法的保密，加密的安全性仅以加密密钥的保密为基础
                    - 4.必须适合不同的用户和不同的应用场合
                    - 5.实现算法的电子器件必须很经济，运行有效
                - 常见加密算法
                    - 经典算法
                        - DES算法
                            - ![](711a7c0d-6278-4118-bb7b-54c95719be15.webp)DES 是以 64 位的明文为一个单位进行加密的，由于每次**只能加密 64 位的数据**，如果加密的明文比较长，就需要对 DES 加密进行迭代
                            - **DES 的基本结构称为费斯妥结构（Feistel structure）**。在费斯妥结构中, 加密的各个步骤称为**轮（round）**，整个加密过程就是进行若干次轮的循环。DES 是一种*16轮*循环的费斯妥结构
                            - 一轮的具体步骤![](1c9a7e0e-fc14-487d-bc47-8cb7d133eeec.webp)
                                - 1.将输入的数据等分为左右两部分
                                - 2. 将输入的右侧直接发送到输出的右侧
                                - 3.将输入的右侧发送到轮函数
                                - 4.费斯妥函数（F函数）根据右侧数据和本轮中加密所使用的密钥（称为**子密钥**），得到二进制数据
                                - 5.将上一步得到的二进制数据与左侧数据进行异或（XOR）运算，并将结果作为解密后的左侧
                                - 再与原本的半块**组合并交换顺序**，进入下一个回次的处理
                            - ![](55b3d4a2-3603-4794-8bf1-405ef7579967.webp)**费斯妥函数（F函数）,每次对半块（32位）进行操作，包括四个步骤**
                                - 扩张 用扩张置换（图中的E）将32位的半块扩展到48位，其输出包括8个6位的块，每块包含4位对应的输入位，加上两个邻接的块中紧邻的位。
                                - 与密钥混合 用异或操作将扩张的结果和一个子密钥进行混合。16个48位的子密钥—每个用于一个回次的F变换—是利用密钥调度从主密钥生成的（见下文）。
                                - S盒 在与子密钥混合之后，块被分成8个6位的块，然后使用“S盒”，或称“置换盒”进行处理。8个S盒的每一个都使用以查找表方式提供的非线性的变换将它的6个输入位变成4个输出位。S盒提供了DES的核心安全性—如果没有S盒，密码会是线性的，很容易破解。
                                - 置换 最后，S盒的32个输出位利用固定的置换，“P置换”进行重组。这个设计是为了将每个S盒的4位输出在下一回次的扩张后，使用4个不同的S盒进行处理。
                        - 3DES
                            - 相当于是对**每个数据块应用三次资料加密标准（DES）算法**
                            - 3DES使用“密钥包”，其包含3个DES密钥，K1，K2和K3，均为56位（除去奇偶校验位）
                            - 加密
                                - ![](c18f3443145f460ea81649ce08cc4012.jpg)使用 K1 为密钥进行 DES 加密，再用 K2 为密钥进行 DES “解密”，最后以 K3 进行 DES 加密
                            - 解密
                                - ![](04af8c5c01f949b48f1585aa3088ceeb.jpg) K3 解密，以 K2 “加密”，最后以 K1 解密
                        - AES
                            - 也是由多个轮（round）所构成，但是没使用*费斯妥结构*，而是使用了 **代码-置换网络（简称 SPN）**。 轮函数任务就是根据密钥编排序列（即轮密码）对数据进行不同的代换及置换等操作
                            - AES加密过程是在一个4×4的字节矩阵上运作，这个矩阵又称为**体（state）**，其初值就是一个明文区块（矩阵中一个元素大小就是明文区块中的一个Byte）
                            - 加密时，各轮AES加密循环（除初始轮和最后一轮）均包含4个步骤
                    - 现代算法
                        - 块加密
                            - **分组密码**是每次只能处理特定长度的一块数据的一类密码算法，这里的“一块”就称为**分组**。此外，一个分组的位数就称为**分组长度**。例如，DES 分组长度为 64 位，AES 的分组长度可以为 128位、192位 和 256位
                            - 分组算法只能加密固定长度的分组，但是明文的长度一般要远大于分组大小，这时就需要对分组密码算法进行迭代，而迭代的方法就称为分组的**模式**
                                - 电子密码本：Electronic Code Book Mode (ECB)
                                    - ECB 模式只是将明文按分组大小切分，然后用同样的密钥正常加密切分好的明文分组
                                - 密码分组链接：Cipher Block Chaining Mode (CBC)
                                - 密文反馈：Cipher Feedback Mode (CFB)
                                - 输出反馈：Output Feedback Mode (OFB)
                                - 计数器模式：Counter Mode (CTR)
                - 采用单钥密码系统的加密方法，同一个密钥同时用作信息的加密和解密，也叫单密钥加密
            - 非对称加密（安全性更高）
                - 使用非对称的加密方式时，会生成两把钥匙。发送方利用自己的公钥加密，接收方利用自己的私钥解密。
                - RSA密钥生成过程
                    - 数论知识
                        - 同余：如果两个整数a和b满足a-b能被m整除，即(a-b)modm=0，那么就称整数a与b对模m同余，记作a≡b(modm)，同时可成立amodm=b
                        - 欧拉函数：任意给定正整数n，计算在小于等于n的正整数之中，**有多少个与n构成互质关系**？计算这个值的方法就叫做欧拉函数，以φ(n)表示
                        - 如果n可以分解成两个互质的整数之积，即n=p×q，则有：φ(n)=φ(pq)=φ(p)φ(q)
                            - 根据“大数是质数的两个数一定是互质数”可以知道：一个数如果是质数，则小于它的所有正整数与它都是互质数；所以如果一个数p是质数，则有：φ(p)=p-1
                            - 若我们知道一个数n可以分解为两个**质数**p和q的乘积，则有φ(n)=(p-1)(q-1)
                        - 欧拉定理：如果两个正整数a和n互质，则n的欧拉函数φ(n)可以让下面的等式成立![](cc5b23bf-679f-4deb-b848-1ca9b1f3bdf1.webp)
                        - 模反元素：![](307b06fe-4a0c-4c2d-beb8-9d5b1f7a8acf.webp)如果两个正整数a和n互质，那么一定可以找到整数b使得ab-1被n整除，或者说ab被n除的余数是1
                            - 如果b是a的模反元素，则 b+kn 都是a的模反元素
                    - 计算过程
                        - 1.随机选择两个不相等的质数p和q（乙选择了61和53）
                        - 2.计算p和q的乘积n=p×q=61×53=3233
                        - 3.根据本文“欧拉函数”介绍过的公式φ(n)=(p-1)(q-1)代入计算n的欧拉函数值φ(3233)=(61-1)×(53-1)=60×52=3120
                        - 4.随机选择一个整数e，条件是1\<e\<φ(n)，且e与φ(n)互质。乙就在1到3120之间，随机选择了17
                        - 5.因为e与φ(n)互质，根据求模反元素的公式计算e，对于e的模反元素d有：ed≡1(modφ(n))这个式子等价于(ed-1)/φ(n)=k（k为任意正整数）即ed-kφ(n)=1，代入数据得：17d-3120k=1实质上就是对以上这个二元一次方程求解得到一组解为：(d,k)=(2753,-15)
                        - 6.将n和e封装成公钥，n和d封装成私钥n=3233，e=17，d=2753所以公钥就是(3233,17)，私钥就是(3233,2753)
                - RSA加密和解密计算过程
                    - 加密：m是原文，c是密文
                        - ![](22f263d3-ac8f-40bc-bdee-2b0912a7ed3e.webp)
                    - 解密：m是原文，c是密文
                        - ![](83947034-4a14-4527-8565-6055da826d6c.webp)
        - 防火墙
            - ![](3beb1e3f-218d-4423-b594-9284b0fefbcd.webp)
            - 防火墙是一种访问控制技术，可以严格控制进出网络边界的分组，禁止任何不必要的通信，来减少前在入侵的发生。它是一种位于内部网络与外部网络之间的网络安全系统。是一项信息安全的防护系统，依照特定的规则，允许或是限制传输的数据通过。
            - 防火墙的区域
                - Local本地地域
                    - 顶级安全区域，安全优先级为100
                    - Local就是防火墙本身的区域比如ping指令等网际控制协议的回复，需要local域的权限凡是由防火墙主动发出的报文均可认为是从local区域中发出是需要防火墙响应并处理（而不是转发）的报文均可认为是Local区域接收
            - 原理：
                - ![](55460639-f5ed-4a9b-bc7c-719f0f2eb94a.jpg)
                - 包过滤（Packet filtering）：工作在网络层，仅根据数据包头中的IP地址、端口号、协议类型等标志确定是否允许数据包通过。
                - 应用代理（Application Proxy）：工作在应用层，通过编写不同的应用代理程序，实现对应用层数据的检测和分析。
                - 状态检测（Stateful Inspection）：工作在2~4层，访问控制方式与1同，但处理的对象不是单个数据包，而是整个连接，通过规则表和连接状态表，综合判断是否允许数据包通过。
                - 完全内容检测（Compelete Content Inspection）：工作在2~7层，不仅分析数据包头信息、状态信息，而且对应用层协议进行还原和内容分析，有效防范混合型安全威胁。
            - Trust受信区
                - 高级安全区域，安全优先级为85
                - 通常用来定义内部用户所在的网络，也可以理解为应该是防护最严密的地区
            - DMZ非军事化区
                - 中级安全区域，安全优先级50
                    - 通常用来定义内部服务器所在网络
                    - 作用是把WEB。E-mail等允许外部访问的服务器单独接在该区域端口，使整个需要访问，实现内外网分离，达到用户需求。DMZ可以理解为一个不同于外网或内网的特殊网络区域，DMZ内通常放置一些不含机密信息的公用服务器，比如Web，Mail，FTP中的服务。这样来自外网的访问者可以访问DMZ中服务，但不可能接触到存放在内网中的公司机密或私人信息等，及时DMZ中服务器受到破坏，也不会对内网中的机密信造成影响
                - Untrust非受信区
                    - 低级安全区域，安全优先级为5
                    - 通常用来定义Internet等不安全的网络，用于网络入口线的接入。
        - 报文鉴别与散列函数
            - 当我们传送不需要加密的报文时，应当使接收者能用很简单的方法鉴别报文的真伪（数字签名需要长时间运算）
            - 报文鉴别的可能方式和要求
                - 报文摘要 MD(Message Digest)
                    - A 将报文 X 经过报文摘要算法运算后得出很短的报文摘要 H。然后然后用自己的私钥对 H 进行 D 运算，即进行数字签名。得出已签名的报文摘要 D(H)后，并将其追加在报文 X 后面发送给 B。B 收到报文后首先把已签名的 D(H) 和报文 X 分离。然后再做两件事。(1) 用A的公钥对 D(H) 进行E运算，得出报文摘要 H 。(2) 对报文 X 进行报文摘要运算，看是否能够得出同样的报文摘要 H。如一样，就能以极高的概率断定收到的报文是 A 产生的。否则就不是
                - 实体鉴别
                    - 实体鉴别是在系统接入的全部持续时间内对和自己通信的对方实体只需验证一次
                        - 最简单的实体鉴别：A 发送给 B 的报文的被加密，使用的是对称密钥 KAB。B 收到此报文后，用共享对称密钥 KAB进行解密，因而鉴别了实体 A 的身份
                        - 重放攻击：入侵者 C 可以从网络上截获 A 发给 B 的报文。C 并不需要破译这个报文（因为这可能很花很多时间）而可以直接把这个由 A 加密的报文发送给 B，使 B 误认为 C 就是 A。然后 B 就向伪装是 A 的 C 发送应发给 A 的报文
                            - 不重数解决：不重数就是一个不重复使用的大随机数，即“一次一数”
                            - 中间人攻击说明A 向 B 发送“我是 A”的报文，并给出了自己的身份。此报文被“中间人” C 截获，C 把此报文原封不动地转发给 B。B 选择一个不重数 RB 发送给 A，但同样被 C 截获后也照样转发给 A。中间人 C 用自己的私钥 SKC 对 RB 加密后发回给 B，使 B 误以为是 A 发来的。A 收到 RB 后也用自己的私钥 SKA 对 RB 加密后发回给 B，中途被 C 截获并丢弃。B 向 A 索取其公钥，此报文被 C截获后转发给 A。C 把自己的公钥 PKC冒充是 A 的发送给 B，而 C 也截获到 A 发送给 B 的公钥 PKA。B 用收到的公钥 PKC（以为是 A 的）对数据加密发送给 A。C 截获后用自己的私钥 SKC 解密，复制一份留下，再用 A 的公钥 PKA对数据加密后发送给 A。A 收到数据后，用自己的私钥 SKA 解密，以为和B进行了保密通信。其实，B发送给A的加密数据已被中间人 C 截获并解密了一份。但 A 和 B 却都不知道。
        - 公钥系统
            - 公钥加密机制的组成元素
                - 公钥、私钥
            - 加密与数字签名
                - 数字签名：是只有信息的发送者才能产生的别人无法伪造的一段数字串，这段数字串同时也是对信息的发送者发送信息真实性的一个有效证明。（将信息类比与人，那么数字签名的作用就类似于身份证。用于对消息的发送者身份及内容的确认） 所以数字签名有两个作用，一个是对消息发送者身份的确认 二是对消息内容未被篡改的确认 
                    - 生成：对要传输的消息原文使用消息摘要算法（MD5 / SHA）生成消息摘要，发送方使用自己的私钥对消息摘要进行加密后生成数字签名。
                    - 验证：数字签名同摘要一同传送给接收方，接收方使用发送方的公钥解密数字签名还原消息摘要，并对消息原文使用相同的消息摘要算法（MD5 / SHA）计算出消息摘要，将这两个消息摘要进行对比，如果不同则说明消息在传输过程中被篡改过。
                - 数字签名的四大特点
                    - 防止重放攻击
                        - 攻击者利用网络监听或则其他方式盗取认证凭据，之后再把它重新发给认证服务器。在数字签名中，如果采用了对签名报文加盖时间戳等或添加流水号等技术，就可以有效防止重放攻击
                    - 防止数据伪造
                        - 其他人不能伪造对消息的签名，因为私有秘钥只能签名者自己知道，所有其他人不可以构造出正确的签名结果数据
                    - 防止数据被篡改
                        - 数字签名与原始文件或摘要一起发送给接受者，一旦信息被篡改，接受者可以通过计算摘要和验证签名来判断该文件无效，从而保证了文件的完整性
                    - 防止数据抵赖
                        - 数字签名既可以作为身份认证的依据，也可以作为签名者签名操作的证据。要防止接受者抵赖，可以在数字签名系统中要求接收者返回一个自己的签名的表示收到报文，给发送者或者信任第三方。如果接受者不返回任何信息，此次通信可终止或重新的开始，签名方也没有任何的损失，由此双方均不可抵赖
            - Diffie-Hellman密钥交换过程
                - **是一种安全交换密钥的方法，可以让双方在不泄漏密钥的情况下，得出一个密钥**
                    - **Diffie-Hellman密钥交换方法在发送和接收双方间建立了一个“秘密通信方法”，目的是为了能够在公共平台发送秘密数据**
                    - 请注意，**如果Diffie-Hellman密钥交换使用与我们示例中的数字一样小，则不安全**
                - 1.Alice和Bob首先相互决定从两个数字开始，模量（p）和基数（g）。在实际使用中，模量（p）是一个非常大的素数，而基数（g）相对较小，以简化计算。基数（g）来自一个循环群（G），该循环群通常在其他步骤发生之前就生成。
                - 2.Alice为自己确定了一个秘密号码（a），而Bob则选择自己的秘密号码（b）。
                - 3.然后，爱丽丝执行以下计算，给她将发送给鲍勃的号码：A = g^a mod p。当我们为鲍勃做同样的事情时，我们会得到：B= g^b mod p
                - 4.然后，爱丽丝把她的结果（A）发给鲍勃，而鲍勃把他的数字（B）发给爱丽丝。
                - 5.然后，爱丽丝使用她从鲍勃（B）那里收到的数字和她的秘密号码（a）来计算共享秘密s，使用以下公式：s = B^a mod p;鲍勃执行本质上相同的计算，s= A^b mod p 
                - 6.双方最终都获得了s的相同结果。这是共同的秘密，只有爱丽丝和鲍勃知道。然后，他们可以用它来设置对称加密的密钥，允许他们以只有他们才能访问的方式在自己之间安全地发送信息。
                - 注意:尽管B和s在上面的例子中是相同的，但这只是基于为本插图选择的小数字的巧合。通常，在Diffie-Hellman密钥交换的实际实现中，这些值将不同。尽管上述大部分数据以明文（p、g、A和B）通过通道发送，并且可以被潜在的攻击者读取，但共享密钥（s）永远不会传输。对于攻击者来说，从以明文发送的信息中计算共享秘密（s）或秘密数字（a和b）是不切实际的。**当然，这假设Diffie-Hellman密钥交换已正确实现，并使用了足够大的数字**。只要遵守这些规定，Diffie-Hellman密钥交换就被认为是建立共享秘密的安全方法，可用于确保未来的通信。
            - 数字证书（DC）的概念和构造,CA（证书认证中心）
                - 数字证书：数字签名依赖于发送方公钥的安全性，如何确保公钥来自真实的发送方而非仿造？这就需要依赖于数字证书。
                    - 生成：1.申请者（即之前所说的消息发送方）将自己的公钥、身份信息等按照 CA 中心要求提交；  2.CA 中心在认证通过后，将申请者的公钥、身份信息和证书有效期等信息合并作为证书原文 `O`  3.CA 中心对证书原文 `O` 执行 Hash 运算得到摘要 `H`；  4.CA 中心使用自己的私钥对摘要 `H` 进行加密得到签名信息 `S`；  5.CA 中心将 `O` 和 `S` 合并成一个文件，这个文件就是数字证书 `DC`
                    - 接收方收到数字证书后使用 CA 中心的公钥对签名信息 `S` 进行解密得到摘要 `H`，然后对证书原文 `O` 执行相同的 Hash 运算得到摘要 `h`，通过 `H` 和 `h` 的对比可以判断证书内容的真实性和完整性。如果证书原文中的公钥和身份信息都是 CA 中心的，说明是 CA 自签名。
                - CA：数字证书认证机构（Certificate Authority，缩写为CA），是负责发放和管理数字证书的权威机构，并作为受信任的第三方，承担公钥体系中 **公钥合法性检验** 的责任。CA 中心为每个使用公开密钥的用户发放一个数字证书，数字证书的作用是证明证书中列出的用户合法拥有证书中列出的公开密钥。全球权威的 CA 中心的证书已被各软件厂商设置为 **可信任的根证书**。所谓 **根证书** 是指此证书是受信任的起始点，可以使用此证书来证明其它证书。这些证书被预置到软件内的过程是未知的，这也是最关键的安全环节。
                    - 防止攻击，在公钥交换的时候
            - 安全电子邮件系统设计
        - 网络各层的安全协议
            - SSL（TLS）
                - 安全[套接字](https://so.csdn.net/so/search?q=%E5%A5%97%E6%8E%A5%E5%AD%97&amp;spm=1001.2101.3001.7020)层（SSL，Secure Sockets Layer)是基于公钥密码体制和X.509数字证书技术，为网络通信提供身份认证以及数据传输保密性、完整性的一种安全协议。
                - ![](9e7db20d-ee7f-4370-905f-67f1c71b9b38.jpg)SSL/TLS是位于传输层与应用层之间的加密协议（属于Socket层实现），对于应用层来说是透明的，应用层数据通过传递给SSL层进行加密，并增加SSL头，再传递给传输层。
                - 组成
                    - 握手协议：协商加密算法、MAC算法以及会话密钥
                        - 建立安全能力、服务端认证和密钥交换、客户端认证和密钥交换、完成握手
                    - 警报协议：当客户机和服务器发现错误时，会向对方发送一个警报消息。如果是致命错误，算法立即终止会话并关闭SSL连接，同时删除相关会话记录、秘密和密钥。
                    - 记录协议：客户端和服务端完成鉴别并确定安全信息交换使用的算法后，进入SSL记录协议，主要提供两个服务:
                        - 数据保密性:使用握手协议定义的秘密密钥对传送的数据加密。
                        - 消息完整性:使用握手协议定义的带有MAC的密钥计算消息认证码。
                        - 记录协议接收到应用程序传送的消息，将数据分片(切成容易管理的小区块)，然后选择是否对这些区块作压缩，再加上此区块的消息认证码，将数据区块与MAC一起做加密处理，加上SSL记录头后通过TCP传送出去。接收数据方对数据进行解密、验证、解压缩、重组，将消息的内容还原，传送给上层应用程序。
                - IPSEC：VPN，隧道协议
                    - IPsec的主要功能是建立安全的隧道，在隧道中传输的数据是加密的，可以保护数据的完整性和安全性。它还可以防止数据泄露，阻止数据篡改，以及实现认证和数据流量控制等功能。
                    - VPN隧道技术是一种把内网中的数据通过安全可靠的通道发送到外网中去的技术。它可以帮助用户安全地使用网络，同时也可以使用户更好地访问到其他网络中的资源。
                - WiFi
                - 防火墙：基本概念和原理

> 例题

## 1

- 广播域和冲突域计算
    - 思路
        - 一个hub就是一个冲突域，不管有多少个hub，只要hub与hub之间是直连的，就都属于一个冲突域
        - 不管有多少个hub，只要hub之间是直连的，就都属于一个广播域
        - 交换机的每一个端口是一个冲突域，交换机与交换机连接的线也属于一个冲突域
        - 一台交换机默认只有一个广播域，两台交换机相连，它们也属于一个
        - **网桥和交换机相似**，因为网桥是只有两个端口的交换机
    - 例题
        - 下图中有多少冲突域和多少个广播域？![](6995a9bd-dddd-466f-a5b2-2ee11c35e8d7.png)
        - 五个冲突域，两个广播域

## 2

- CRC冗余校验计算
    - 思路：
        - 1.根据多项式获得模2数
        - 2.在发送数据后面补多项式最大项数个0作为被模2数
        - 用这两个数进行模2（异或）操作，得到最后的余数，位数也是多项式最大项数
        - 这个余数的作用
            - 补在原数据后，可以作为检验数，模2运算答案为0
    - 例题：要发送的数据为1101011011，采用CRC的生成多项式是P（x）=x^4+x+1.求余数。

## 3

- 子网划分



## 4

- 虚电路连接
- **一：虚电路网络**



曾经的许多网络体系结构(包括 ATM、帧中继)都是虚电路网络，在网络层使用连接，这 些网络层连接被称为虚电路。



尽管虚电路技术已经不再使用，但是类似的思想在电话网络和多协议标记交换网络 (MPLS)还是有其应用，因此学习虚电路技术还是有必要的。



**一条虚电路(VC)的组成如下:**



**①源和目的主机之间的路径(即一系列链路和路由器);**



**②VC 号，沿着该路径的每段链路一个号码;**



**③沿着该路径的每台路由器中的转发表表项。**



属于一条虚电路的分组将在它的首部携带一个 VC 号。因为一条虚电路在每条链路上可能具有不同的VC号，所以每台中间路由器必须用一个新的VC号替代每个传输分组的VC号。 这个新的 VC 号从转发表中获得。



考虑图中的网络，现在假定主机 A 请求该网络在它自己与主机 B 之间创建一条虚电路。 同时假定该网络为该虚电路选择路径 A-R1-R2-B，并为这条路径上的这 3 条链路分配 VC 号 12、22 和 32。在这种情况下，当这条虚电路中的分组离开主机 A 时，该分组首部中的 VC 字段的值是 12；当它离开 R1 时该值是 22，而当它离开 R2 时该值是 32。

![](4c8d6459-e42d-4476-b525-39c84fbd29a0.webp)

对于分组通过某路由器，该路由器怎样决定 VC 号的更换呢?对于虚电路网络，每台路由 器的转发表包括了 VC 号的转换。例如，R1 中的转发表可能是：![](09fb5294-2a2e-4658-9944-9bc292d80996.webp)

